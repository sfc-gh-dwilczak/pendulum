{% extends "base/main.html" %}

{% block title %} Edit Code {% endblock %}

{% block content %}

<h1>Edit and Run Python Script</h1>
<div id="editor" style="height:400px;"></div>
<button onclick="submitCode()" class="btn btn-primary mt-3">Run Code</button>
<div id="output" class="mt-3" style="white-space: pre-wrap;"></div> <!-- Add this line -->

<script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.20.0/min/vs/loader.js"></script>
<script>
    require.config({ paths: { 'vs': 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.20.0/min/vs' }});

    var editor;
    require(['vs/editor/editor.main'], function() {
        editor = monaco.editor.create(document.getElementById('editor'), {
            value: '# Write your Python code here\n',
            language: 'python',
            theme: 'vs-dark'
        });
    });

    function submitCode() {
        var code = editor.getValue();
        fetch("/run_code", {
            method: "POST",
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({code: code})
        }).then(response => response.json())
        .then(data => {
            document.getElementById('output').textContent = data.output || "No output."; // Update this line
        });
    }
</script>

{% endblock %}